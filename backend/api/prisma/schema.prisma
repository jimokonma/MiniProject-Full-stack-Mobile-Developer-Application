// Prisma schema for Doovo Hiring Exercise â€“ UltraSimplified (Customer Only)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum BookingType {
  dropoff
  mobile_wash
}

enum BookingStatus {
  accepted
  on_the_way
  washing
  complete
  cancel
}

model User {
  id        String    @id @default(cuid())
  name      String
  email     String    @unique
  password  String
  createdAt DateTime  @default(now())
  bookings  Booking[]
  notes     Notification[]
}

model Booking {
  id           String        @id @default(cuid())
  user         User          @relation(fields: [userId], references: [id])
  userId       String
  type         BookingType
  status       BookingStatus @default(accepted)
  vehicleMake  String
  vehicleModel String
  vehiclePlate String
  location     String
  scheduledFor DateTime
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  notifications Notification[]
}

model Notification {
  id        String   @id @default(cuid())
  user      User     @relation(fields: [userId], references: [id])
  userId    String
  booking   Booking? @relation(fields: [bookingId], references: [id])
  bookingId String?
  type      String
  message   String
  createdAt DateTime @default(now())
}

model IdempotencyKey {
  id           String   @id @default(cuid())
  key          String
  userId       String
  method       String
  path         String
  responseBody Json
  createdAt    DateTime @default(now())

  @@unique([key, userId])
}


